<style>
.sprite { -webkit-transition: left 0.2s,top 0.2s;}
</style>
<script src="Sprite.js"></script>
<script>
window.onload=function(){
	var make_sprite=Sprite(32,8,26,"fantasy-tileset.png");
	var map=Map(
		make_sprite,[
		0,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0,
		0,0,0,1,0,1,0,0,
		0,0,0,1,0,1,0,0,
		0,1,1,1,0,1,0,0,
		0,0,0,0,0,1,1,1,
		0,0,0,0,0,0,0,0, 
		0,0,0,0,0,0,0,0,
	],8,{
		"0":{tile:30,walkable:true},
		"1":{tile:24,walkable:false},
	},document.getElementById("map"));

	var dir=[[1,0],[-1,0],[0,-1],[0,1]];
	function make_enemy(n,x,y){
		var sprite=make_sprite(n,x,y)
		function move(){
			sprite.move(dir[~~(Math.random()*4)],map.check)
			setTimeout(move,100)
		}
		move()
		return sprite;
	}

	var pc=make_sprite([147],2,3);
	var enemy=make_enemy(179,4,4);
	var enemy2=make_enemy(179,2,2);
	
	document.body.onkeydown=function(e){
		if(e.keyCode==39) pc.move([1,0],map.check)
		if(e.keyCode==37) pc.move([-1,0],map.check)
		if(e.keyCode==38) pc.move([0,-1],map.check)
		if(e.keyCode==40) pc.move([0,1],map.check)
	}
	map.appendChild(pc)
	map.appendChild(enemy)
	map.appendChild(enemy2)
}
</script>
<style>
</style>
<div id="map">
</div>
