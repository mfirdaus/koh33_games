<style>
.sprite { -webkit-transition: left 0.1s,top 0.1s;}
</style>
<script src="Sprite.js"></script>
<script>
window.onload=function(){
	var make_sprite=Sprite(32,8,26,"fantasy-tileset.png");

	
	var terrain={
		"0":29,
		"1":24
	}
	var map=[
		0,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0,
		0,0,0,1,0,0,0,0,
		0,0,0,1,0,0,0,0,
		0,1,1,1,0,0,0,0,
		0,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0, 
		0,0,0,0,0,0,0,0,
	]
	map_width=8;


	map_obj=document.getElementById("map")
	for(var i=0;i<map.length;i++){
		map_obj.appendChild(make_sprite(terrain[map[i]],i%map_width,~~(i/map_width),0.5))
	}
		function _x(n){
			return n%map_width;
		}
		function _y(n){
			return ~~(n/map_width)
		}
		function _n(x,y){
			return x+y*map_width;
		}

		var x=1,y=2;
		var pc=make_sprite(147,x,y);
		pc.left=function(){
			if(x-1>=0){
				if(0==map[_n(x-1,y)]){
					pc.move(-1,0)
					x=x-1;
					console.log(x)
				}
			}
		}
		pc.right=function(){
			if(x+1<=map_width-1){
				if(0==map[_n(x+1,y)]){
					pc.move(+1,0)
					x=x+1;
					console.log(x)
				}
			}
		}
		pc.down=function(){
			if(y+1<=map_width-1){
				if(0==map[_n(x,y+1)]){
					pc.move(0,+1)
					y++;
					console.log(x)
				}
			}
		}
		pc.up=function(){
			if(y-1>=0){
				if(0==map[_n(x,y-1)]){
					pc.move(0,-1)
					y--;
					console.log(x)
				}
			}
		}
		map_obj.appendChild(pc)
	document.body.onkeyup=function(e){
		if(e.keyCode==39) pc.right()
		if(e.keyCode==37) pc.left()
		if(e.keyCode==38) pc.up()
		if(e.keyCode==40) pc.down()
	}
}
</script>
<style>
</style>
<div id="map">
</div>
